import pypyodbc # para conectar a um Access DB
import requests # para baixar um arquivo usando python
import zipfile # para trabalhar com zipfiles
from zipfile import ZipFile
import pandas as pd

url = 'https://rgl.faa.gov/Regulatory_and_Guidance_Library/rgad.nsf/1f3d470805e57a0786257bce004f3976/d7876e8a7bb0e2aa86257beb0051e285/$FILE/AD.zip'
r = requests.get(url, allow_redirects=True)
# carrega o arquivo que se deseja baixar
open('ADES.zip', 'wb').write(r.content) #salva com o nome que eu quero. Leva uns 20 segundos e cospe o tamanho do arquivo em bytes

#"""Extract example .zip file into this directory"""
archive = zipfile.ZipFile('ADES.zip', 'r')
archive.extractall(path=None, members=None, pwd=None)

pypyodbc.lowercase = False
PAFF = r''
conn = pypyodbc.connect(
    r"Driver={Microsoft Access Driver (*.mdb, *.accdb)};" +
    r"Dbq=e:\OneDrive\Documentos\LCN Consultoria\Tests on BD\AD.accdb;")
cur = conn.cursor()

query = 'SELECT * FROM ADs_by_Model'
dataf = pd.read_sql(query, conn)

select_model = 'A320-111'
dataf[dataf.Model==select_model]
